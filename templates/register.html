<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>íšŒì›ê°€ì…</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body class="auth-bg">
<div class="auth-container">
    <h1>ğŸ“ íšŒì›ê°€ì…</h1>
    <div class="notice-box">
        âš ï¸ ì´ë¦„ê³¼ ì—°ë½ì²˜ëŠ” ì •í™•í•˜ê²Œ ì…ë ¥í•´ì£¼ì„¸ìš”.<br>
        í—ˆìœ„ ì •ë³´ ì…ë ¥ ì‹œ ì‚¬ì „ ì•ˆë‚´ ì—†ì´ ê³„ì •ì´ ì‚­ì œë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    </div>
    <div class="error" id="error"></div>
    <div class="success" id="success"></div>
    <div class="form-group">
        <label>ì•„ì´ë””</label>
        <input type="text" id="userId">
    </div>
    <div class="form-group">
        <label>ë¹„ë°€ë²ˆí˜¸</label>
        <input type="password" id="password">
    </div>
    <div class="form-group">
        <label>ë¹„ë°€ë²ˆí˜¸ í™•ì¸</label>
        <input type="password" id="password2">
    </div>
    <div class="form-group">
        <label>ì´ë¦„</label>
        <input type="text" id="name">
    </div>
    <div class="form-group">
        <label>ì—°ë½ì²˜</label>
        <input type="text" id="phone" placeholder="01012345678">
    </div>
    <button class="auth-btn auth-btn-primary" onclick="doRegister()">ê°€ì…í•˜ê¸°</button>
    <button class="auth-btn auth-btn-secondary" onclick="location.href='/login'">ë¡œê·¸ì¸ìœ¼ë¡œ</button>
</div>
<script>
async function doRegister() {
    const u = document.getElementById('userId').value;
    const p = document.getElementById('password').value;
    const p2 = document.getElementById('password2').value;
    const n = document.getElementById('name').value;
    const ph = document.getElementById('phone').value.replace(/-/g, '');
    const err = document.getElementById('error');
    const suc = document.getElementById('success');
    
    err.style.display = 'none';
    suc.style.display = 'none';
    
    if (!u || !p || !p2 || !n || !ph) {
        err.textContent = 'ëª¨ë“  í•­ëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.';
        err.style.display = 'block';
        return;
    }
    if (p !== p2) {
        err.textContent = 'ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.';
        err.style.display = 'block';
        return;
    }
    
    try {
        const r = await fetch('/api/register', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({userId: u, password: p, name: n, phone: ph})
        });
        const d = await r.json();
        if (d.success) {
            suc.innerHTML = 'íšŒì›ê°€ì… ì™„ë£Œ!<br>ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.';
            suc.style.display = 'block';
            setTimeout(() => location.href = '/login', 1500);
        } else {
            err.textContent = d.message;
            err.style.display = 'block';
        }
    } catch(x) {
        err.textContent = 'ì„œë²„ ì—°ê²° ì‹¤íŒ¨';
        err.style.display = 'block';
    }
}
</script>
</body>
</html>
